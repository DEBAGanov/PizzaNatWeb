<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å –ú–µ—Ç—Ä–∏–∫–∞ E-commerce</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        button { margin: 5px; padding: 10px 15px; background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
        .log { background: #f8f9fa; padding: 10px; margin: 10px 0; border-left: 3px solid #007bff; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º–µ—Ä—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å –ú–µ—Ç—Ä–∏–∫–∏</h1>
    
    <div class="test-section">
        <h2>1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</h2>
        <button onclick="initYandexMetrika()">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫—É</button>
        <div id="init-status" class="log">–°—Ç–∞—Ç—É—Å: –ù–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>
    </div>

    <div class="test-section">
        <h2>2. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞</h2>
        <button onclick="testProductView()">–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–∏—Ü—Ü—ã –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞</button>
        <div id="product-log" class="log">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
    </div>

    <div class="test-section">
        <h2>3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É</h2>
        <button onclick="testAddToCart()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
        <div id="cart-add-log" class="log">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
    </div>

    <div class="test-section">
        <h2>4. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</h2>
        <button onclick="testRemoveFromCart()">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</button>
        <div id="cart-remove-log" class="log">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
    </div>

    <div class="test-section">
        <h2>5. –ü–æ–∫—É–ø–∫–∞</h2>
        <button onclick="testPurchase()">–¢–µ—Å—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞</button>
        <div id="purchase-log" class="log">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
    </div>

    <div class="test-section">
        <h2>6. –ü—Ä–æ–≤–µ—Ä–∫–∞ dataLayer</h2>
        <button onclick="checkDataLayer()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ dataLayer</button>
        <div id="datalayer-log" class="log">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏...</div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è dataLayer
        window.dataLayer = window.dataLayer || [];

        function initYandexMetrika() {
            // –ò–º–∏—Ç–∞—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏
            const counterId = '103585127';
            
            const script = document.createElement('script');
            script.innerHTML = `
                (function(m,e,t,r,i,k,a){
                    m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
                    m[i].l=1*new Date();
                    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
                    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
                })(window, document,'script','https://mc.yandex.ru/metrika/tag.js','ym');

                ym(${counterId}, 'init', {
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true,
                    ecommerce:"dataLayer"
                });
            `;
            
            document.head.appendChild(script);
            document.getElementById('init-status').innerHTML = '‚úÖ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å ecommerce: "dataLayer"';
        }

        function testProductView() {
            const productData = {
                ecommerce: {
                    currencyCode: "RUB",
                    detail: {
                        products: [{
                            id: "1",
                            name: "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
                            price: 450,
                            brand: "–î–ò–ú–ë–û –ü–∏—Ü—Ü–∞",
                            category: "–ü–∏—Ü—Ü–∞",
                            list: "–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ü–∏–∏",
                            position: 1
                        }]
                    }
                }
            };

            window.dataLayer.push(productData);
            document.getElementById('product-log').innerHTML = '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞:<br><pre>' + JSON.stringify(productData, null, 2) + '</pre>';
        }

        function testAddToCart() {
            const addToCartData = {
                ecommerce: {
                    currencyCode: "RUB",
                    add: {
                        products: [{
                            id: "1",
                            name: "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
                            price: 450,
                            brand: "–î–ò–ú–ë–û –ü–∏—Ü—Ü–∞",
                            category: "–ü–∏—Ü—Ü–∞",
                            quantity: 1,
                            list: "–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ü–∏–∏",
                            position: 1
                        }]
                    }
                }
            };

            window.dataLayer.push(addToCartData);
            document.getElementById('cart-add-log').innerHTML = '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É:<br><pre>' + JSON.stringify(addToCartData, null, 2) + '</pre>';
        }

        function testRemoveFromCart() {
            const removeFromCartData = {
                ecommerce: {
                    currencyCode: "RUB",
                    remove: {
                        products: [{
                            id: "1",
                            name: "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
                            price: 450,
                            brand: "–î–ò–ú–ë–û –ü–∏—Ü—Ü–∞",
                            category: "–ü–∏—Ü—Ü–∞",
                            quantity: 1,
                            list: "–ö–æ—Ä–∑–∏–Ω–∞",
                            position: 1
                        }]
                    }
                }
            };

            window.dataLayer.push(removeFromCartData);
            document.getElementById('cart-remove-log').innerHTML = '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã:<br><pre>' + JSON.stringify(removeFromCartData, null, 2) + '</pre>';
        }

        function testPurchase() {
            const purchaseData = {
                ecommerce: {
                    currencyCode: "RUB",
                    purchase: {
                        actionField: {
                            id: "ORDER_123",
                            affiliation: "–î–ò–ú–ë–û –ü–∏—Ü—Ü–∞ - –î–æ—Å—Ç–∞–≤–∫–∞ –ø–∏—Ü—Ü—ã",
                            revenue: 650,
                            shipping: 200
                        },
                        products: [{
                            id: "1",
                            name: "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
                            price: 450,
                            brand: "–î–ò–ú–ë–û –ü–∏—Ü—Ü–∞",
                            category: "–ü–∏—Ü—Ü–∞",
                            quantity: 1
                        }]
                    }
                }
            };

            window.dataLayer.push(purchaseData);
            document.getElementById('purchase-log').innerHTML = '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∞:<br><pre>' + JSON.stringify(purchaseData, null, 2) + '</pre>';
        }

        function checkDataLayer() {
            const dataLayerContent = window.dataLayer || [];
            document.getElementById('datalayer-log').innerHTML = 
                '<strong>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ window.dataLayer (' + dataLayerContent.length + ' —ç–ª–µ–º–µ–Ω—Ç–æ–≤):</strong><br><pre>' + 
                JSON.stringify(dataLayerContent, null, 2) + '</pre>';
        }
    </script>

    <noscript>
        <div><img src="https://mc.yandex.ru/watch/103585127" style="position:absolute; left:-9999px;" alt="" /></div>
    </noscript>
</body>
</html>
